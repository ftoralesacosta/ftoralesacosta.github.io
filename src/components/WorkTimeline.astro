---
// src/components/WorkTimeline.astro
import Icon from './Icon.astro';

const workExperiences = [
    {
        date: "June 2025 - Present",
        title: "Machine Learning Engineer",
        company: { name: "Google (Alphabet)", url: "https://about.google/" },
        description: "I'm currently a machine learning engineer working on the AI for Workspace team at Google, where I'll work on improving popular services like Drive, Docs, Sheets, and more.",
        icons: ["google"],
    },
    {
        date: "Feb 2022 - June 2025",
        title: "Postdoctoral Researcher",
        company: { name: "Lawrence Berkeley National Lab", url: "https://nachmangroup.github.io/html/People.html" },
        description: "I was a postdoctoral research fellow in the machine learning for fundamental physics group, led by Benjamin Nachman. We worked at the intersection of physics and deep learning. I worked on detector data deconvolution, differentiable detector design, and generative modeling for collider data.",
        icons: ["lbl"],
    },
    {
        date: "May 2016 - Dec 2021",
        title: "Doctoral Researcher",
        company: { name: "University of California, Berkeley", url: "https://repository.cern/records/7g8jz-z7a45" },
        description: "I conducted my PhD research as a member of the ALICE collaboration at CERN. I worked on identifiyng 'deep photons' where we used modern CNNs to identify photons produced in the initial hard scattering. My theses focused on studying parton fragmentation by measuring isolated γ-hadron correlations in pp and p–Pb collisions.",
        icons: ["ucb","cern"],
    },
];
---

<section class="timeline-section">
    <h2 class="timeline-title">Experience</h2>
    <div class="timeline-container">
        {workExperiences.map((item) => (
        <div class="timeline-item">
            {/* ADDED: A dedicated container for the line and dot */}
            <div class="timeline-spine">
                <div class="line top"></div>
                <div class="timeline-dot"></div>
                <div class="line bottom"></div>
            </div>

            {/* The content card remains mostly the same */}
            <div class="timeline-content">
                {item.icons && item.icons.length > 0 && (
                <div class="timeline-icons-container">
                    {item.icons.map((iconName) => (
                    <Icon icon={iconName} />
                    ))}
                </div>
                )}
                <div class="text-content-wrapper">
                    <time class="timeline-date">{item.date}</time>
                    <h3>{item.title}</h3>
                    <h4>
                        {item.company.url ? (
                        <a href={item.company.url} target="_blank" rel="noopener noreferrer">
                            {item.company.name}
                        </a>
                        ) : (
                            item.company.name
                        )}
                    </h4>
                    <p>{item.description}</p>
                </div>
            </div>
        </div>
        ))}
    </div>

</section>

<style>
  /* --- Section & Title --- */
  .timeline-section {
    padding: 3rem 1rem;
    max-width: 90%; /* A bit more width for modern screens */
    margin: 0 auto;
  }
  .timeline-title {
    text-align: center;
    font-size: 2.7rem;
    margin-bottom: 3rem;
    font-weight: 700;
  }

  /* --- Main Timeline Layout --- */
  .timeline-container {
    display: flex;
    flex-direction: column;
    gap: 1.5rem; /* Replaces margin-bottom on items */
  }

  /* 1. The main flex container for each timeline entry */
  .timeline-item {
    display: flex;
    gap: 1.5rem; /* Space between the spine and the content card */
    align-items: stretch; /* Ensures columns are equal height */
  }

  /* 2. The new 'spine' for the line and dot */
  .timeline-spine {
    display: flex;
    flex-direction: column;
    align-items: center;
    flex-shrink: 0; /* Prevents the spine from shrinking */
    width: 30px; /* Explicit width for alignment */
  }

  /* 3. The connecting line segments */
  .line {
    width: 6px;
    background-color: var(--gray-500);
    flex-grow: 2; /* This makes the line fill available space! */
  }

  /* Hide lines for the first and last items */
  .timeline-item:first-child .line.top,
  .timeline-item:last-child .line.bottom {
    visibility: hidden;
  }

  /* 4. The timeline dot, now much simpler */
  .timeline-dot {
    width: 28px;
    height: 28px;
    background-color: var(--color-background);
    border: 3px solid var(--accent-regular);
    border-radius: 50%;
    flex-shrink: 0; /* Prevents dot from shrinking */
  }

  /* Highlight the dot for the most recent entry */
  .timeline-item:first-child .timeline-dot {
    background-color: var(--accent-regular);
  }

  /* --- Content Card Styles (Mostly Unchanged) --- */
  .timeline-content {
    background: var(--gradient-subtle);
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--gray-800);
    padding: 1.5rem;
    border-radius: 1.5rem;
    transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
    flex-grow: 1;
    display: flex;
    align-items: center;
    gap: 1.5rem;
  }
  .timeline-content:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-md);
  }

  .text-content-wrapper { flex-grow: 1; }
  .timeline-date { font-size: 1.75rem; color: var(--gray-300); margin-bottom: 0.75rem; display: block; font-weight: 500; }
  .timeline-content h3 { margin-top: 0; margin-bottom: 0.75rem; color: var(--gray-100); font-size: 1.75rem; font-weight: 600; }
  .timeline-content h4 { margin-top: 0; margin-bottom: 0.75rem; color: var(--gray-50); font-size: 1.2rem; font-weight: 600; }
  .timeline-content p { margin-bottom: 0; line-height: 1.7; color: var(--gray-300); font-size: 1.20rem; }
  .timeline-content h4 a { color: inherit; text-decoration: none; transition: color 0.2s ease-in-out; border-bottom: 2px solid transparent; padding-bottom: 2px; }
  .timeline-content h4 a:hover { color: var(--accent-regular); border-bottom-color: var(--accent-regular); }

  /* --- Icon Styles --- */
  .timeline-icons-container { display: flex; flex-direction: column; justify-content: center; gap: 0.5rem; flex-shrink: 0; }
  .timeline-icons-container :global(svg) { width: 7.75rem; height: 7.75rem; opacity: 0.9; color: var(--gray-400); }
  
  /* --- Responsive Styles --- */
  @media (max-width: 768px) {
    .timeline-section {
      max-width: 100%;
    }
    .timeline-item {
      gap: 1rem; /* Reduce gap on mobile */
    }
    .timeline-spine {
      width: 20px; /* Make the spine column smaller */
    }
    .timeline-dot {
      width: 28px;
      height: 28px;
    }
    .timeline-content {
      flex-direction: column; /* Stack icons and text on mobile */
      align-items: flex-start;
      padding: 1rem;
    }
    .timeline-icons-container {
      flex-direction: row; /* Lay out icons horizontally */
    }
    .timeline-icons-container :global(svg) {
      width: 4rem; /* Your already-fixed icon size */
      height: 4rem;
    }
    .timeline-content h3 { font-size: 1.2rem; }
  }
</style>
